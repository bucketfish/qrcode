<!DOCTYPE html>
<html>
<body>
  <style>
    body {
      font-family: Verdana;
      display:flex;
      flex-flow:column;
      align-items:center;
      padding-top: 80px;
      background: #8499B1;
    }
    #gd {
      display: grid;
    }
    .c {
      width: 25px;
      height: 25px;
      border: 1px solid #A5C4D4;
    }
    .alive {background: #A5C4D4;}

  </style>
  <h1>conway's game of life :)</h1>
  <div id="gd"></div>
  <script>
    var audio = new Audio("data:audio/wav;base64,UklGRkQAAABXQVZFZm10IBAAAAABAAEAiBUAAIgVAAABAAgAZGF0YSAAAAB/bZR2dpJ5dH+bZX+Xan+KiG5/jXl6f4l9en+Cgnx/fw==")
    const rs = 20, cs = 20, gd = document.getElementById('gd')
    var md = false
    gd.style.gridTemplateRows = `repeat(${rs}, 30px)`
    gd.style.gridTemplateColumns = `repeat(${cs}, 30px)`
    const cells = []
    for (let row = 0; row < rs; row++) {
      const rC = []
      for (let col = 0; col < cs; col++) {
        const c = document.createElement('div')
        c.classList.add('c')
        c.addEventListener('click', () => {c.classList.toggle('alive')})
        c.dataset.r = row
        c.dataset.c = col
        gd.appendChild(c)
        rC.push(c)
      }
      cells.push(rC)
    }
    function hb(event){if(event.target.dataset.r && event.target.dataset.c){
      event.target.classList.add('alive')
      audio.pause()
      audio.currentTime = 0
      audio.play()
    }}
    gd.addEventListener('mousedown', (event) => {
        md = true
        hb(event)
    })
    gd.addEventListener('mousemove', (event) => {if (md) hb(event)})
    gd.addEventListener('mouseup', () => {md = false})
    function ng() {
      const newStates = cells.map((row, r) =>
        row.map((cell, c) => {
          const alive = cell.classList.contains('alive');
          const neighbors = ga(r, c);
          if (alive && (neighbors === 2 || neighbors === 3)) return true;
          if (!alive && neighbors === 3) return true;
          return false;
        })
      )
      cells.forEach((row, r) =>
        row.forEach((cell, c) => {
          if (newStates[r][c]) {
            cell.classList.add('alive')
          } else {cell.classList.remove('alive')}})
      )}
    function ga(r, c) {
      let count = 0;
      for (let dr of [-1, 0, 1]) {
        for (let dc of [-1, 0, 1]) {
          if (dr === 0 && dc === 0) continue;
          const nr = r + dr, nc = c + dc;
          if (nr >= 0 && nr < rs && nc >= 0 && nc < cs) {
            if (cells[nr][nc].classList.contains('alive')) { count++}
          }}}
      return count
    }
    setInterval(ng, 500)
  </script>
</body>
</html>
